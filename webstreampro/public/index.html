<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebStreamPro - YouTube Live Management</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üé• WebStreamPro</h1>
            <p>YouTube Live Stream Management System</p>
            <div id="authStatus" class="auth-status">Not Authenticated</div>
        </header>

        <div id="authSection" class="section">
            <h2>Authentication</h2>
            
            <div class="alert alert-info" style="margin-bottom: 20px;">
                <strong>‚ö†Ô∏è Before you start:</strong><br>
                Make sure you've added this redirect URI to your Google Cloud Console:<br>
                <code id="redirectUriDisplay" style="background: white; padding: 5px; display: inline-block; margin-top: 5px;">
                    http://localhost:3000/api/auth/callback
                </code>
                <button onclick="copyRedirectUri()" class="btn btn-secondary" style="margin-left: 10px; padding: 5px 15px;">Copy</button>
                <br><br>
                <a href="https://console.cloud.google.com/apis/credentials" target="_blank" style="color: #667eea;">
                    ‚Üí Open Google Cloud Console
                </a>
                <br>
                <small>Need help? Check <a href="/TROUBLESHOOTING_AUTH.md" target="_blank" style="color: #667eea;">Troubleshooting Guide</a></small>
            </div>
            
            <div class="form-group">
                <label>1. Upload Client Secret JSON:</label>
                <input type="file" id="clientSecretFile" accept=".json">
                <button onclick="uploadClientSecret()" class="btn btn-primary">Upload</button>
                <br>
                <small style="color: #666;">Download this from Google Cloud Console ‚Üí Credentials ‚Üí OAuth 2.0 Client ID</small>
            </div>
            <div class="form-group">
                <label>2. Login with Google:</label>
                <button onclick="login()" id="loginBtn" class="btn btn-success" disabled>Login with Google</button>
            </div>
            <div id="channelSelect" class="form-group" style="display: none;">
                <label>3. Select Channel:</label>
                <select id="channelDropdown" onchange="selectChannel()">
                    <option value="">-- Select Channel --</option>
                </select>
            </div>
        </div>

        <div id="mainContent" style="display: none;">
            <div class="tabs">
                <button class="tab-btn active" onclick="showTab('broadcasts')">Broadcasts</button>
                <button class="tab-btn" onclick="showTab('videos')">Video Upload</button>
                <button class="tab-btn" onclick="showTab('scheduled')">Scheduled Tasks</button>
                <button class="tab-btn" onclick="showTab('upcoming')">Upcoming Broadcasts</button>
            </div>

            <div id="broadcastsTab" class="tab-content active">
                <h2>Create Broadcasts</h2>
                
                <div class="form-group">
                    <label>Upload Excel File:</label>
                    <input type="file" id="excelFile" accept=".xlsx,.xls">
                    <button onclick="parseExcel()" class="btn btn-primary">Parse Excel</button>
                </div>

                <div id="broadcastPreview" style="display: none;">
                    <h3>Preview</h3>
                    <div id="previewContent"></div>
                    <div class="button-group">
                        <button onclick="createBatchImmediate()" class="btn btn-success">Create All Now</button>
                        <button onclick="showScheduleModal()" class="btn btn-warning">Schedule Batch</button>
                    </div>
                </div>

                <div id="batchResults" class="results"></div>
            </div>

            <div id="videosTab" class="tab-content">
                <h2>Upload Video</h2>
                
                <div class="form-group">
                    <label>Video File:</label>
                    <input type="file" id="videoFile" accept="video/*">
                </div>

                <div class="form-group">
                    <label>Thumbnail (optional):</label>
                    <input type="file" id="thumbnailFile" accept="image/*">
                </div>

                <div class="form-group">
                    <label>Title:</label>
                    <input type="text" id="videoTitle" placeholder="Video Title">
                </div>

                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="videoDescription" rows="4" placeholder="Video Description"></textarea>
                </div>

                <div class="form-group">
                    <label>Tags (comma separated):</label>
                    <input type="text" id="videoTags" placeholder="tag1, tag2, tag3">
                </div>

                <div class="form-group">
                    <label>Privacy:</label>
                    <select id="videoPrivacy">
                        <option value="public">Public</option>
                        <option value="unlisted">Unlisted</option>
                        <option value="private">Private</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="videoMadeForKids">
                        Made for Kids
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="videoSyntheticMedia">
                        Contains Synthetic Media
                    </label>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="videoMonetization">
                        Enable Monetization
                    </label>
                </div>

                <div class="button-group">
                    <button onclick="uploadVideo(false)" class="btn btn-success">Upload Now</button>
                    <button onclick="uploadVideo(true)" class="btn btn-warning">Schedule Upload</button>
                </div>

                <div id="videoProgress" class="progress" style="display: none;">
                    <div class="progress-bar" id="videoProgressBar"></div>
                </div>
            </div>

            <div id="scheduledTab" class="tab-content">
                <h2>Scheduled Tasks</h2>
                
                <h3>Scheduled Batches</h3>
                <div id="scheduledBatchesList"></div>
                <button onclick="loadScheduledBatches()" class="btn btn-primary">Refresh</button>
                <button onclick="clearCompletedBatches()" class="btn btn-secondary">Clear Completed</button>

                <h3>Scheduled Video Uploads</h3>
                <div id="scheduledUploadsList"></div>
                <button onclick="loadScheduledUploads()" class="btn btn-primary">Refresh</button>
                <button onclick="clearCompletedUploads()" class="btn btn-secondary">Clear Completed</button>
            </div>

            <div id="upcomingTab" class="tab-content">
                <h2>Upcoming Broadcasts</h2>
                <button onclick="loadUpcomingBroadcasts()" class="btn btn-primary">Refresh</button>
                <div id="upcomingBroadcastsList"></div>
            </div>
        </div>

        <div id="scheduleModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeScheduleModal()">&times;</span>
                <h2>Schedule Batch Creation</h2>
                <div class="form-group">
                    <label>Batch Name:</label>
                    <input type="text" id="batchName" placeholder="My Batch">
                </div>
                <div class="form-group">
                    <label>Scheduled Time:</label>
                    <input type="datetime-local" id="batchScheduleTime">
                </div>
                <button onclick="scheduleBatch()" class="btn btn-success">Schedule</button>
            </div>
        </div>

        <div id="logs" class="logs"></div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>
